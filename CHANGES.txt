Functions are entirely redesigned from the legacy version.